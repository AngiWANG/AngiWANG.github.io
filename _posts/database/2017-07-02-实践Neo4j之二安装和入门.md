---
layout: post
title: "实践Neo4j之二安装和入门"
date: 2017-07-02 09:00:00 +0800
categories: 数据库
tags: database nosql neo4j
---

## Installation

操作系统：deepin linux 15.4.1

### JDK

jdk：1.8.0_101

### Neo4j

版本：community-3.2.1

设置NEO4J_HOME环境变量

```shell
$ $NEO4J_HOME/bin/neo4j --help
Usage: neo4j { console | start | stop | restart | status | version }
```

```shell
//console模式启动
$ $NEO4J_HOME/bin/neo4j console
Active database: graph.db
Directories in use:
  home:         /home/angi/software/neo4j
  config:       /home/angi/software/neo4j/conf
  logs:         /home/angi/software/neo4j/logs
  plugins:      /home/angi/software/neo4j/plugins
  import:       /home/angi/software/neo4j/import
  data:         /home/angi/software/neo4j/data
  certificates: /home/angi/software/neo4j/certificates
  run:          /home/angi/software/neo4j/run
Starting Neo4j.
WARNING: Max 10240 open files allowed, minimum of 40000 recommended. See the Neo4j manual.
2017-07-07 08:20:02.907+0000 INFO  ======== Neo4j 3.2.1 ========
2017-07-07 08:20:03.161+0000 INFO  Starting...
2017-07-07 08:20:04.691+0000 INFO  Bolt enabled on 127.0.0.1:7687.
2017-07-07 08:20:10.441+0000 INFO  Started.
2017-07-07 08:20:11.252+0000 INFO  Remote interface available at http://localhost:7474/
```

*默认数据库数据目录为/home/angi/software/neo4j/data/databases/graph.db*

### Neo4j Browser

Neo4j Browser是Neo4j 2.0新推出的web控制台，2.0以前是Neo4j Web Admin Console。

首次访问需要重置neo4j的密码，初始密码是neo4j

[Neo4j Browser (localhost:7474)](http://localhost:7474)

![neo4j server connect](/images/neo4j-server-connect.png)

![neo4j browser](/images/neo4j-browser.png)

### Neo4j Shell

neo4j shell是neo4j自带的客户端，可以连接访问本地或远程neo4j数据库

- 连接本地

  本地不需要启动neo4j，-path指定neo4j数据库数据目录

```shell
$ $NEO4J_HOME/bin/neo4j-shell -path /home/angi/software/neo4j/data/databases/graph.db
NOTE: Local Neo4j graph database service at '/home/angi/software/neo4j/data/databases/graph.db'
Welcome to the Neo4j Shell! Enter 'help' for a list of commands. Please note that neo4j-shell is deprecated and to be replaced by cypher-shell.


neo4j-sh (?)$ start keanu = node(1) return keanu;
+----------------------------------------+
| keanu                                  |
+----------------------------------------+
| Node[1]{name:"Keanu Reeves",born:1964} |
+----------------------------------------+
1 row
619 ms
neo4j-sh (?)$ 
```

如果指定一个非neo4j数据库数据的目录，则会新建数据库数据，如下/home/angi/software/abc是个空目录

```shell
$ neo4j-shell -path /home/angi/software/abc
NOTE: Local Neo4j graph database service at '/home/angi/software/abc'
Welcome to the Neo4j Shell! Enter 'help' for a list of commands. Please note that neo4j-shell is deprecated and to be replaced by cypher-shell.


neo4j-sh (?)$ start keanu = node(1) return keanu;
+-------+
| keanu |
+-------+
+-------+
0 row
552 ms
neo4j-sh (?)$
```

```shell
$ ls abc
index                                 neostore.nodestore.db.labels             neostore.relationshipgroupstore.db
logs                                  neostore.nodestore.db.labels.id          neostore.relationshipgroupstore.db.id
neostore                              neostore.propertystore.db                neostore.relationshipstore.db
neostore.counts.db.a                  neostore.propertystore.db.arrays         neostore.relationshipstore.db.id
neostore.id                           neostore.propertystore.db.arrays.id      neostore.relationshiptypestore.db
neostore.labelscanstore.db            neostore.propertystore.db.id             neostore.relationshiptypestore.db.id
neostore.labeltokenstore.db           neostore.propertystore.db.index          neostore.relationshiptypestore.db.names
neostore.labeltokenstore.db.id        neostore.propertystore.db.index.id       neostore.relationshiptypestore.db.names.id
neostore.labeltokenstore.db.names     neostore.propertystore.db.index.keys     neostore.schemastore.db
neostore.labeltokenstore.db.names.id  neostore.propertystore.db.index.keys.id  neostore.schemastore.db.id
neostore.nodestore.db                 neostore.propertystore.db.strings        neostore.transaction.db.0
neostore.nodestore.db.id              neostore.propertystore.db.strings.id     store_lock
angi@angi-deepin:~/software$ 
```



- 连接远程

默认配置下没有开启远程shell服务，通过修改**neo4j.conf**中如下配置开启

```properties
## Enable a remote shell server which Neo4j Shell clients can log in to.
dbms.shell.enabled=true
## The network interface IP the shell will listen on (use 0.0.0.0 for all interfaces).
dbms.shell.host=127.0.0.1
## The port the shell will listen on, default is 1337.
dbms.shell.port=1337
```
远程neo4j启动后进行连接
```shell
$ $NEO4J_HOME/bin/neo4j-shell -host localhost -port 1337
Welcome to the Neo4j Shell! Enter 'help' for a list of commands. Please note that neo4j-shell is deprecated and to be replaced by cypher-shell.
NOTE: Remote Neo4j graph database service 'shell' at port 1337

neo4j-sh (?)$ start keanu = node(1) return keanu;
+----------------------------------------+
| keanu                                  |
+----------------------------------------+
| Node[1]{name:"Keanu Reeves",born:1964} |
+----------------------------------------+
1 row
20 ms
neo4j-sh (?)$ 
```

### Cypher Shell

